
CREATE TABLE dbo.TEMA
( 
	IDTEMA               integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKTEMA PRIMARY KEY (IDTEMA ASC)
)
go



CREATE TABLE dbo.AUTOR
( 
	IDAUTOR              integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(100)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	CONSTRAINT XPKAUTOR PRIMARY KEY (IDAUTOR ASC)
)
go



CREATE TABLE dbo.LIBRO
( 
	IDLIBRO              integer IDENTITY ( 1,1 ) ,
	TITULO               varchar(200)  NOT NULL ,
	IDTEMA               integer  NOT NULL ,
	IDAUTOR              integer  NOT NULL ,
	CONSTRAINT XPKLIBRO PRIMARY KEY (IDLIBRO ASC),
	CONSTRAINT FK_LIBRO_TEMA FOREIGN KEY (IDTEMA) REFERENCES dbo.TEMA(IDTEMA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_LIBRO_AUTOR FOREIGN KEY (IDAUTOR) REFERENCES dbo.AUTOR(IDAUTOR)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.SITUACION
( 
	IDSITUACION          integer  NOT NULL ,
	DESCRIPCION          varchar(20)  NOT NULL ,
	CONSTRAINT XPKSITUACION PRIMARY KEY (IDSITUACION ASC)
)
go



CREATE TABLE dbo.EJEMPLAR
( 
	IDEJEMPLAR           integer IDENTITY ( 1,1 ) ,
	IDLIBRO              integer  NOT NULL ,
	IDSITUACION          integer  NOT NULL ,
	CODIGO               varchar(20)  NOT NULL ,
	EDICION              integer  NOT NULL ,
	EDITORIAL            varchar(20)  NOT NULL ,
	ANIO                 integer  NOT NULL ,
	CONSTRAINT XPKEJEMPLAR PRIMARY KEY (IDEJEMPLAR ASC),
	CONSTRAINT FK_EJEMPLAR_LIBRO FOREIGN KEY (IDLIBRO) REFERENCES dbo.LIBRO(IDLIBRO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_EJEMPLAR_SITUACION FOREIGN KEY (IDSITUACION) REFERENCES dbo.SITUACION(IDSITUACION)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.ESTUDIANTE
( 
	IDESTUDIANTE         integer IDENTITY ( 1,1 ) ,
	CODIGO               varchar(9)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKESTUDIANTE PRIMARY KEY (IDESTUDIANTE ASC)
)
go



CREATE TABLE dbo.ESTADO
( 
	IDESTADO             integer  NOT NULL ,
	DESCRIPCION          varchar(100)  NOT NULL ,
	CONSTRAINT XPKESTADO PRIMARY KEY (IDESTADO ASC)
)
go



CREATE TABLE dbo.PRESTAMO
( 
	IDPRESTAMO           integer IDENTITY ( 1,1 ) ,
	IDESTUDIANTE         integer  NOT NULL ,
	IDEJEMPLAR           integer  NOT NULL ,
	IDESTADO             integer  NOT NULL ,
	FECHA_INICIO         datetime  NULL ,
	FECHA_FIN            datetime  NOT NULL ,
	FECHA_DEVOLUCION     datetime  NULL ,
	CONSTRAINT XPKPRESTAMO PRIMARY KEY (IDPRESTAMO ASC),
	CONSTRAINT FK_PRESTAMO_EJEMPLAR FOREIGN KEY (IDEJEMPLAR) REFERENCES dbo.EJEMPLAR(IDEJEMPLAR)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_PRESTAMO_ESTUDIANTE FOREIGN KEY (IDESTUDIANTE) REFERENCES dbo.ESTUDIANTE(IDESTUDIANTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_PRESTAMO_ESTADO FOREIGN KEY (IDESTADO) REFERENCES dbo.ESTADO(IDESTADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.EMPLEADO
( 
	IDEMPLEADO           integer IDENTITY ( 1,1 ) ,
	APELLIDOS            varchar(100)  NOT NULL ,
	NOMBRES              varchar(100)  NOT NULL ,
	DNI                  varchar(20)  NOT NULL ,
	CORREO               varchar(100)  NOT NULL ,
	CONSTRAINT XPKEMPLEADO PRIMARY KEY (IDEMPLEADO ASC)
)
go



CREATE TABLE dbo.ROL
( 
	IDROL                integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKROL PRIMARY KEY (IDROL ASC)
)
go



CREATE TABLE dbo.USUARIO
( 
	IDEMPLEADO           integer  NOT NULL ,
	IDROL                integer  NOT NULL ,
	USUARIO              varchar(20)  NOT NULL ,
	CLAVE                varchar(20)  NOT NULL ,
	ACTIVO               integer  NOT NULL 
	CONSTRAINT CHK_USUARIO_ACTIVO
		CHECK  ( ACTIVO IN (0,1) ),
	CONSTRAINT XPKUSUARIO PRIMARY KEY (IDEMPLEADO ASC),
	CONSTRAINT FK_USUARIO_EMPLEADO FOREIGN KEY (IDEMPLEADO) REFERENCES dbo.EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_USUARIO_ROL FOREIGN KEY (IDROL) REFERENCES dbo.ROL(IDROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go


